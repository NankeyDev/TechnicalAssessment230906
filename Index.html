<!DOCTYPE html>

<html>
  <head>
    <base target="_top">

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/dataTables.bootstrap4.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/dataTables.bootstrap4.min.css">

    <script>
      function addRow() {
        // Get form values
        var taskName = document.getElementById("taskname").value;
        var taskDescription = document.getElementById("taskdescription").value;
        var taskType = document.getElementById("tasktype").value;
        var taskDueDate = document.getElementById("taskduedate").value;
        var taskLabel = document.getElementById("tasklabel").value;

        // Add object information to google sheet
        google.script.run.addRecord(taskName, taskDescription, taskType, taskDueDate, taskLabel);

        // Clears form values
        document.getElementById("taskName").value = '';
      }

      google.script.run.withSuccessHandler(viewData).getData();
 
      function viewData(dataArray){
        $(document).ready(function(){
          $('#datatable').DataTable({
            data: dataArray,
            columns: [		
              {"title":"Name"},
              {"title":"Description"},
              {"title":"Type"},
              {"title":"Due Date"},
              {"title":"Label"}
            ]
          });
        });
      }
    </script>

  </head>

  <body>
    <form>
      <!-- Task Input Form -->
      <label for="taskname">Name:</label><br>
      <input type = "text" id="taskname" /><br>

      <label for="taskdescription">Description:</label><br>
      <input type = "text" id="taskdescription" /><br>

      <label for="tasktype">Type:</label><br>
      <select name="tasktype" id="tasktype">
        <option value="Work">Work</option>
        <option value="Personal">Personal</option>
        <option value="Health">Health</option>
        <option value="Other">Other</option>
      </select><br>

      <label for="taskduedate">Due Date:</label><br>
      <input type = "date" id="taskduedate" name="taskduedate" value="" min="1900-01-01" max="2100-12-31"/><br>

      <label for="tasklabel">Label:</label><br>
      <input type = "text" id="tasklabel" /><br>

      <input type = "button" value = "Add" onclick="addRow()"/><br>
    </form>

    <br>
    Current Tasks:<br>
    <!-- Table View of Data -->
    <div class="container">
        <br>
        <div class="row">
          <table id="datatable" class="table table-striped table-sm table-hover table-bordered">
          </table>
        </div>
    </div> 

  </body>
</html>